<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Game Ular Tangga Kuis</title>

  <!-- Styles utama -->
  <link rel="stylesheet" href="style.css" />

  <!-- (opsional) styling kecil tombol back + musik -->
  <style>
    .nav-buttons {
      position: absolute; top: 10px; width: 100%;
      display: flex; justify-content: flex-start;
      padding: 0 20px; box-sizing: border-box;
      z-index: 9;
    }
    .nav-buttons button { background: transparent; border: none; cursor: pointer; transition: transform .2s; }
    .nav-buttons img { width: 48px; height: 48px; }
    .nav-buttons button:hover { transform: scale(1.1); }

    /* Kontrol musik pojok kanan atas */
    .music-controls{
      position: fixed; top: 30px; right: 70px;
      display: flex; align-items: center; gap: 8px;
      background: rgba(0,0,0,.4); padding: 6px 10px; border-radius: 8px;
      z-index: 9999;
    }
    .music-controls button{
      background: transparent; border:none; padding:0; cursor:pointer;
      display: inline-flex; align-items: center; justify-content: center;
    }
    #bgmIcon{ width: 28px; height: 28px; display:block; object-fit: contain; }
    .music-controls input[type="range"]{ accent-color:#ff4444; cursor:pointer; }
  </style>
</head>
<body>

  <!-- ===== Kontrol Musik (pojok kanan atas) ===== -->
  <div class="music-controls" aria-label="Kontrol Musik">
    <button id="bgmToggle" type="button" aria-label="Toggle Musik">
      <img id="bgmIcon" src="assets/on.png" alt="Musik ON" />
    </button>
    <input id="bgmVolume" type="range" min="0" max="1" step="0.01" value="0.6" aria-label="Volume Musik" />
  </div>

  <!-- ===== Menu Awal ===== -->
  <div id="menuAwal" class="screen active" data-next="menuMode">
    <img src="assets/logo.png" alt="Logo Game" class="logo" />
    <button id="playBtn" class="play-btn" aria-label="Mulai">
      <img src="assets/play.png" class="play-button" alt="Tombol Mulai" />
    </button>
  </div>

  <!-- ===== Menu Pilih Mode ===== -->
  <div id="menuMode" class="screen" data-prev="menuAwal" data-next="menuLawan">
    <div class="nav-buttons">
      <button onclick="goBack(this)" aria-label="Kembali"><img src="assets/back.png" alt="Kembali" /></button>
    </div>

    <h2>
      <img src="assets/pilihmode.png" alt="Pilih Mode" class="pilih-mode-title" />
    </h2>

    <div class="mode-buttons">
      <button class="mode-btn" onclick="selectMode('single')" aria-label="Mode Single Player">
        <img src="assets/single.png" alt="Single Player"/>
      </button>
      <button class="mode-btn" onclick="selectMode('multi')" aria-label="Mode Multiplayer">
        <img src="assets/multi.png" alt="Multiplayer"/>
      </button>
    </div>
  </div>

  <!-- ===== Menu Pilih Lawan ===== -->
  <div id="menuLawan" class="screen" data-prev="menuMode" data-next="menuPemain">
    <div class="nav-buttons">
      <button onclick="goBack(this)" aria-label="Kembali"><img src="assets/back.png" alt="Kembali" /></button>
    </div>

    <h2>
      <img src="assets/pilihlawan.png" alt="Pilih Lawan" class="pilih-lawan-title" />
    </h2>

    <div class="lawan-buttons">
      <button class="lawan-btn" onclick="selectOpponent('komputer')" aria-label="Lawan Komputer">
        <img src="assets/manusia vs komputer.png" alt="Manusia vs Komputer"/>
      </button>
      <button class="lawan-btn" onclick="selectOpponent('player')" aria-label="Lawan Pemain">
        <img src="assets/manusia vs manusia.png" alt="Manusia vs Manusia"/>
      </button>
    </div>
  </div>

  <!-- ===== Menu Pilih Pemain ===== -->
  <div id="menuPemain" class="screen" data-prev="menuLawan">
    <div class="nav-buttons">
      <button onclick="goBack(this)" aria-label="Kembali"><img src="assets/back.png" alt="Kembali" /></button>
    </div>

    <h2>
      <img src="assets/masukkan nama pemain.png" alt="Ikon Pemain" class="player-icon" />
    </h2>

    <label for="playerCount">Jumlah Pemain (2â€“4):</label>
    <input type="number" id="playerCount" min="2" max="4" value="2" />

    <div id="playerInputs">
      <input type="text" id="player1" placeholder="Nama Pemain 1" />
      <input type="text" id="player2" placeholder="Nama Pemain 2" />
    </div>

    <!-- Tombol Mulai (ikon) -->
    <button class="start-btn" onclick="startGame()" aria-label="Mulai Game">
      <img src="assets/MULAI GAME.png" alt="Ikon Mulai Game" class="start-icon" />
    </button>
  </div>

  <!-- ===== Game Board ===== -->
  <div id="gameBoard" class="screen game-layout">
    <!-- Panel kiri: Giliran -->
    <aside id="leftPanel">
      <p id="turnInfo"></p>
    </aside>

    <!-- Papan di tengah -->
    <div id="board" class="board"></div>

    <!-- Panel kanan: Dadu + tombol -->
    <aside id="rightPanel">
      <div class="dice-view">
        <img id="diceIcon" src="assets/d1.png" alt="Ikon dadu" />
      </div>
      <button id="rollDiceBtn">Lempar Dadu</button>
      <p id="diceResult"></p>
    </aside>
  </div>

  <!-- ===== Kuis ===== -->
  <div id="quizBox" class="quiz-box hidden" role="dialog" aria-modal="true" aria-labelledby="quizQuestion">
    <p id="quizQuestion"></p>
    <div id="quizOptions"></div>
  </div>

  <!-- ===== Hasil Permainan ===== -->
<div id="resultScreen" class="screen" data-prev="gameBoard">
  <div class="result-wrapper">
    <h2 style="color:#fff;margin:0;">Hasil Permainan</h2>

    <table class="result-table" id="resultTable">
      <thead>
        <tr>
          <th>Pemain</th>
          <th>Benar</th>
          <th>Salah</th>
          <th>Poin</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="result-actions">
      <button onclick="goTo('menuAwal')">Home</button>
      <button onclick="startGame()">Main Lagi</button>
    </div>
  </div>
</div>


  <!-- ===== Audio Elements ===== -->
  <audio id="bgm"     src="assets/audio/latarbelakang.mp3" preload="auto" loop></audio>
  <audio id="sfxDice" src="assets/audio/dadu.mp3"           preload="auto"></audio>
  <audio id="sfxUp"   src="assets/audio/naik.mp3"           preload="auto"></audio>
  <audio id="sfxDown" src="assets/audio/turun.mp3"          preload="auto"></audio>

  <!-- ===== Inisialisasi global agar aman saat Pages me-render sebelum data siap ===== -->
  <script>
    window.quizBank = window.quizBank || [];
  </script>

  <!-- MUAT DATA KUIS LEBIH DULU (tanpa type="module") -->
  <script src="./quizData.js?v=4" defer></script>

  <!-- (Opsional) file lain -->
  <script src="./diceData.js?v=5" defer></script>
  <script src="./BoardPlayer.js?v=5" defer></script>
  <script src="./Game.js?v=5" defer></script>

  <!-- TERAKHIR: logika utama -->
  <script src="./script.js?v=16" defer></script>

  <!-- (opsional) kontrol musik inline ringan agar ikon langsung sinkron saat halaman dibuka -->
  <script>
    (function setupBgmControls(){
      const bgm        = document.getElementById('bgm');
      const btnToggle  = document.getElementById('bgmToggle');
      const icon       = document.getElementById('bgmIcon');
      const volSlider  = document.getElementById('bgmVolume');

      const setIcon = () => {
        if (!bgm || !icon || !btnToggle) return;
        if (bgm.paused) {
          icon.src = 'assets/off.png';
          icon.alt = 'Musik OFF';
          btnToggle.setAttribute('aria-label','Musik OFF');
        } else {
          icon.src = 'assets/on.png';
          icon.alt = 'Musik ON';
          btnToggle.setAttribute('aria-label','Musik ON');
        }
      };

      const unlock = () => {
        if (!bgm || bgm.dataset.started) return;
        bgm.volume = parseFloat(volSlider?.value || '0.6');
        bgm.play().catch(()=>{});
        bgm.dataset.started = '1';
        setIcon();
        window.removeEventListener('click', unlock);
      };
      window.addEventListener('click', unlock, { once:true });

      btnToggle?.addEventListener('click', () => {
        if (bgm.paused) { bgm.play().catch(()=>{}); } else { bgm.pause(); }
        setIcon();
      });

      volSlider?.addEventListener('input', (e) => {
        const v = parseFloat(e.target.value);
        if (bgm) bgm.volume = isNaN(v) ? 0.6 : v;
      });

      bgm?.addEventListener('play', setIcon);
      bgm?.addEventListener('pause', setIcon);

      setIcon();
    })();
  </script>
</body>
</html>

